(()=>{"use strict";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},n(t)}function t(n,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(n,e(o.key),o)}}function e(t){var e=function(t,e){if("object"!=n(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var o=a.call(t,e||"default");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==n(e)?e:e+""}var a=window.jQuery;const o=function(){function n(){!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n)}return e=n,r=[{key:"init",value:function(n,t){this.$table=n,this.settings=t,this.bindEvents(n,t)}},{key:"bindEvents",value:function(n,t){this.bindVariationChange(n),this.bindQuantity(n),this.bindAddToCart(n,t)}},{key:"bindEventsFor",value:function(n,t){this.bindEvents(n,t)}},{key:"getNewUrl",value:function(n,t,e){var a=new URL(n);return a.searchParams.set("item_id",t),a.searchParams.set("quantity",e),a.toString()}},{key:"bindVariationChange",value:function(t){t.on("change",".nt_fct_variations_select",function(t){var e=a(this),o=e.find(":selected"),r=e.closest("tr"),i=e.closest(".nt_fct_variations_wrapper").data("product_id"),c=o.data("variation_id")||0,d=o.data("formatted_price")||"",l=o.data("compared_price")||"",p=o.data("image_src")||"",u=o.data("stock")||0,s=e.closest(".nt_fct_variations_wrapper").data("product_type")||"",f=r.data("is_compare_row")||!1,_=r.data("row_id")||!1,b=function(n){var t=r.find(n);return t.length?t:r.parent().find(n)},v=b(".nt_fct_product_price_wrapper");f&&(v=b('[data-pid="'+i+'"] .nt_fct_product_price_wrapper')),v.find(".nt_fct_product_price").text(d);var m=v.find(".nt-fct-compared-price");l?m.text(l).show():m.hide();var h=b(".fct_product_image");_?h=b('[data-row_id="'.concat(r.data("row_id"),'"] .fct_product_image')):f&&(h=b('[data-pid="'.concat(i,'"] .fct_product_image'))),p&&h&&h.attr("src",p);var y=b(".nt_fct_product_stock");f&&(y=b('[data-pid="'+i+'"] .nt_fct_product_stock')),y.length&&y.attr("data-product_stock",u).text(u);var g=b(".nt_fct_add_to_cart_".concat(i));if(g.attr("data-variation_id",c),"digital"===s){(g=b(".nt_fct_buy_now_".concat(i))).attr("data-variation_id",c);var x=r.find(".nt_fct_add_cart_wrapper a"),k=x.data("quantity")||1,w=n.getNewUrl(x.attr("href"),c,k);x.attr("href",w)}})}},{key:"bindQuantity",value:function(t){t.on("change",".nt_fct_quantity",function(){var e=a(this),o=e.data("product_type"),r=e.data("product_id"),i=Math.max(1,parseInt(e.val(),10)||1);e.val(i);var c=t.find(".nt_fct_add_to_cart_".concat(r));"digital"===o&&(c=t.find(".nt_fct_buy_now_".concat(r))),c.attr("data-quantity",i);var d=c.data("variation_id");if("digital"===o){var l=n.getNewUrl(c.attr("href"),d,i);c.attr("href",l)}})}},{key:"bindAddToCart",value:function(t,e){t.on("click",'[class*="nt_fct_add_to_cart_"]:not(.loading)',function(t){var o;t.preventDefault();var r=a(this),i=r.parent();if(!r.data("processing")){r.data("processing",!0),i.addClass("loading"),r.prop("disabled",!0);var c=null===(o=t.target)||void 0===o?void 0:o.dataset;if(c){var d={product_id:c.product_id,variation_id:parseInt(c.variation_id),quantity:c.quantity};n._ajaxAdd([d],r,i,e)}}})}},{key:"_ajaxAdd",value:function(n,t,e,o){var r=window.ninja_footables||{},i=r.ajax_url,c=r.ninja_table_public_nonce;a.post(i,{action:"ninja_table_wp_fct_add_to_cart",nonce:c,table_id:(null==o?void 0:o.table_id)||this.settings.table_id,products:n}).done(function(n){null!=n&&n.success&&n.cart_html?(a(".ninjatable_cart_wrapper.fluent-cart").length?a(".ninjatable_cart_wrapper.fluent-cart").replaceWith(n.cart_html):a(".ninja_table_wrapper").append(n.cart_html),e&&e.addClass("added").removeClass("loading"),setTimeout(function(){e&&e.removeClass("loading"),t&&t.prop("disabled",!1).removeData("processing")},1e3)):(e&&e.removeClass("loading"),t&&t.prop("disabled",!1).removeData("processing"))}).fail(function(){e&&e.removeClass("loading"),t&&t.prop("disabled",!1).removeData("processing")})}}],(o=null)&&t(e.prototype,o),r&&t(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,o,r}();function r(n){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},r(n)}function i(n,t){for(var e=0;e<t.length;e++){var a=t[e];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(n,c(a.key),a)}}function c(n){var t=function(n,t){if("object"!=r(n)||!n)return n;var e=n[Symbol.toPrimitive];if(void 0!==e){var a=e.call(n,t||"default");if("object"!=r(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(n)}(n,"string");return"symbol"==r(t)?t:t+""}var d=window.jQuery;const l=function(){return n=function n(){!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n)},e=[{key:"init",value:function(n,t){this.$table=n,this.settings=t,this.appendStyles()}},{key:"createComparisonModal",value:function(n,t){var e=this;if(n.length<2||n.length>5)return alert("Select 2–5 products");var a="nt_cmp_".concat(t.table_id);d("#".concat(a)).remove(),d("body").append('\n            <div id="'.concat(a,'" class="nt_cmp_overlay">\n                <div class="nt_cmp_content">\n                    <div class="nt_cmp_header">\n                        <h3>Compare (').concat(n.length,')</h3>\n                        <button class="nt_cmp_close">×</button>\n                    </div>\n                    <div class="nt_cmp_body">\n                        <div id="cmp_').concat(a,'" class="loading">Loading comparison...</div>\n                    </div>\n                    <div class="nt_cmp_footer">\n                        <button class="nt_btn nt_btn_sec" id="close_cmp">Close</button>\n                    </div>\n                </div>\n            </div>')),d("#".concat(a)).fadeIn(),setTimeout(function(){return e.render(n,t,a)},80),d("#".concat(a)).on("click",".nt_cmp_close, #close_cmp",function(){return e.close(a)}),d("#".concat(a)).on("click",function(n){return n.target===n.currentTarget&&e.close(a)}),d(document).on("keydown.cmp",function(n){return"Escape"===n.key&&e.close(a)})}},{key:"close",value:function(n){d("#".concat(n)).fadeOut(function(){d("#".concat(n)).remove(),d(document).off("keydown.cmp")})}},{key:"render",value:function(n,t,e){var a='\n            <div class="cmp_wrap">\n                <table class="nt_cmp_table">\n                    <thead>\n                        <tr>\n                            <th class="prop">Feature</th>\n                            '.concat(n.map(function(t){return"<th>Product ".concat(n.indexOf(t)+1,"</th>")}).join(""),"\n                        </tr>\n                    </thead>\n                    <tbody>");(t.columns||[]).forEach(function(t){t.visible&&!t.key.includes("editing")&&n.some(function(n){return n[t.key]})&&(a+='<tr data-is_compare_row="true">\n                                <td class="prop">'.concat(t.title,"</td>"),n.forEach(function(n){var e=n.cart.product_id,o=n[t.key]||"",r=/buy|add_to_cart/.test(t.key)?"act":/quantity/.test(t.key)?"qty":/image/.test(t.key)?"img":/price/.test(t.key)?"price":"val";a+='<td class="'.concat(r,'" data-pid="').concat(e,'" data-key="').concat(t.key,'">').concat(o,"</td>")}),a+="</tr>")}),a+="</tbody>\n                </table>\n            </div>",d("#cmp_".concat(e)).html(a),this.bindEvents(d("#".concat(e)),t)}},{key:"bindEvents",value:function(n,t){var e=n.find(".nt_cmp_table");o.init(e,t)}},{key:"appendStyles",value:function(){d("#nt_cmp_style").length||d("head").append('\n            <style id="nt_cmp_style">\n                /* Overlay & Modal */\n                .nt_cmp_overlay {\n                    position: fixed;\n                    top: 0; left: 0;\n                    width: 100%; height: 100%;\n                    background: rgba(0,0,0,0.6);\n                    z-index: 10000;\n                    display: none;\n                    overflow: auto;\n                    padding: 20px;\n                    box-sizing: border-box;\n                }\n\n                .nt_cmp_content {\n                    margin: 40px auto;\n                    background: #fff;\n                    border-radius: 12px;\n                    max-width: 95%;\n                    width: 1200px;\n                    max-height: 90vh;\n                    overflow: hidden;\n                    box-shadow: 0 15px 40px rgba(0,0,0,0.3);\n                    display: flex;\n                    flex-direction: column;\n                }\n\n                /* Header - Compact */\n                .nt_cmp_header {\n                    padding: 14px 20px;\n                    background: #f8f9fa;\n                    border-bottom: 1px solid #eee;\n                    display: flex;\n                    justify-content: space-between;\n                    align-items: center;\n                    flex-shrink: 0;\n                }\n\n                .nt_cmp_header h3 {\n                    margin: 0;\n                    font-size: 18px;\n                    font-weight: 600;\n                    color: #333;\n                }\n\n                .nt_cmp_close {\n                    background: none;\n                    border: none;\n                    font-size: 28px;\n                    cursor: pointer;\n                    color: #999;\n                    padding: 0;\n                    width: 36px;\n                    height: 36px;\n                    display: flex;\n                    align-items: center;\n                    justify-content: center;\n                }\n\n                .nt_cmp_close:hover {\n                    color: #333;\n                }\n\n                /* Body - Scrollable */\n                .nt_cmp_body {\n                    flex: 1;\n                    overflow: auto;\n                    padding: 0;\n                }\n\n                .cmp_wrap {\n                    overflow: auto;\n                    min-width: 800px;\n                }\n\n                /* Table Styling */\n                .nt_cmp_table {\n                    width: 100%;\n                    border-collapse: collapse;\n                    font-size: 14px;\n                    background: #fff;\n                }\n\n                .nt_cmp_table th,\n                .nt_cmp_table td {\n                    padding: 12px 16px;\n                    border: 1px solid #e0e0e0;\n                    text-align: left;\n                    vertical-align: top;\n                }\n\n                .nt_cmp_table th {\n                    background: #f5f5f5;\n                    font-weight: 600;\n                    color: #333;\n                    position: sticky;\n                    top: 0;\n                    z-index: 10;\n                    font-size: 13px;\n                    text-transform: uppercase;\n                    letter-spacing: 0.5px;\n                }\n\n                .prop {\n                    width: 180px;\n                    min-width: 180px;\n                    background: #f8f9fa !important;\n                    font-weight: 600;\n                    position: sticky;\n                    left: 0;\n                    z-index: 11;\n                    box-shadow: 2px 0 5px rgba(0,0,0,0.05);\n                }\n\n                /* Cell Types */\n                .act a, .act button {\n                    display: inline-block;\n                    padding: 8px 14px;\n                    background: #a46497;\n                    color: #fff;\n                    border: none;\n                    border-radius: 6px;\n                    font-size: 13px;\n                    cursor: pointer;\n                    text-decoration: none;\n                    font-weight: 500;\n                }\n\n                .act a:hover, .act button:hover {\n                    background: #8b3f7a;\n                }\n\n                .act a.loading, .act button.loading {\n                    opacity: 0.7;\n                    cursor: not-allowed;\n                }\n\n                .act a.added {\n                    background: #28a745;\n                }\n\n                .img img {\n                    max-width: 80px;\n                    max-height: 80px;\n                    object-fit: cover;\n                    border-radius: 6px;\n                    border: 1px solid #eee;\n                }\n\n                .qty input {\n                    width: 70px;\n                    padding: 6px 8px;\n                    text-align: center;\n                    border: 1px solid #ddd;\n                    border-radius: 4px;\n                }\n\n                .price {\n                    font-weight: 600;\n                    color: #e91e63;\n                    font-size: 15px;\n                }\n\n                /* Footer */\n                .nt_cmp_footer {\n                    padding: 16px 20px;\n                    border-top: 1px solid #eee;\n                    text-align: right;\n                    background: #f8f9fa;\n                    flex-shrink: 0;\n                }\n\n                .nt_btn_sec {\n                    padding: 10px 20px;\n                    background: #6c757d;\n                    color: #fff;\n                    border: none;\n                    border-radius: 6px;\n                    cursor: pointer;\n                    font-size: 14px;\n                }\n\n                .nt_btn_sec:hover {\n                    background: #5a6268;\n                }\n\n                /* Responsive */\n                @media (max-width: 768px) {\n                    .nt_cmp_content {\n                        margin: 10px auto;\n                        width: calc(100% - 20px);\n                        max-height: 95vh;\n                    }\n\n                    .nt_cmp_header {\n                        padding: 12px 16px;\n                    }\n\n                    .nt_cmp_header h3 {\n                        font-size: 16px;\n                    }\n\n                    .nt_cmp_table th,\n                    .nt_cmp_table td {\n                        padding: 10px 12px;\n                        font-size: 13px;\n                    }\n\n                    .prop {\n                        width: 140px;\n                        min-width: 140px;\n                    }\n\n                    .cmp_wrap {\n                        min-width: 600px;\n                    }\n                }\n\n                @media (max-width: 480px) {\n                    .cmp_wrap {\n                        min-width: 500px;\n                    }\n\n                    .act a, .act button {\n                        padding: 6px 10px;\n                        font-size: 12px;\n                    }\n                }\n            </style>\n        ')}}],(t=null)&&i(n.prototype,t),e&&i(n,e),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,t,e}();function p(n){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},p(n)}function u(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})),e.push.apply(e,a)}return e}function s(n,t,e){return(t=function(n){var t=function(n,t){if("object"!=p(n)||!n)return n;var e=n[Symbol.toPrimitive];if(void 0!==e){var a=e.call(n,t||"default");if("object"!=p(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(n)}(n,"string");return"symbol"==p(t)?t:t+""}(t))in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}jQuery(document).ready(function(n){var t={},e={},a=null,r=function(n){var t;return null===(t=n.attr("class"))||void 0===t||null===(t=t.match(/nt_row_id_(\S+)/))||void 0===t?void 0:t[1]},i=function(t){return t.find("tbody tr:visible").map(function(t,e){var a=n(e),o=r(a);return o&&a.find(".ninja-compare-checkbox:checked").length?o:null}).get().filter(Boolean)},c=function(e,r,i){var c=e.closest(".ninja_table_wrapper").find(".ninja-bulk-actions-tr");c.length&&(c.off("change.bulk").off("click.bulk"),c.on("change.bulk",".ninja-bulk-action-select",function(){var t=n(this).val();n(this).data("action",t),p(e,r,t)}),c.on("click.bulk",".ninja-bulk-apply-btn",function(){var n=c.find(".ninja-bulk-action-select").data("action");if(n&&t[r].length){var d=f(e,r);if("compare"===n)l.createComparisonModal(d,a),_(e,r);else if("add_to_cart"===n){var p=d.map(function(n){return n.cart});o._ajaxAdd(p,null,"",i),_(e,r)}}}),c.find(".ninja-bulk-apply-btn").attr("data-table-id",r))},d=function(a,o){a.off("change.bulk").on("change.bulk",".ninja-compare-checkbox",function(){if(!e[o]){var c=n(this),d=c.closest("tr");if(!r(d))return c.prop("checked",!1);var l=a.find(".ninja-compare-checkbox:checked").length;c.prop("checked")&&l>20?c.prop("checked",!1):(t[o]=i(a),b(a,o))}}),a.off("click.toggle").on("click.toggle",".ninja-compare-checkbox-toggle",function(c){c.stopPropagation();var d=n(this);setTimeout(function(){var c=d.prop("checked"),l=a.find("tbody tr:visible").filter(function(t,e){return r(n(e))});if(e[o]=!0,l.find(".ninja-compare-checkbox").prop("checked",!1),c&&t[o].length<20){var p=0;l.each(function(){if(p>=20)return!1;var t=n(this).find(".ninja-compare-checkbox");t.is(":visible")&&(t.prop("checked",!0),p++)})}e[o]=!1,t[o]=i(a),b(a,o)},0)})},p=function(n,a,o){var r=FooTable.get(n);r&&(e[a]=!0,r.rows.all.forEach(function(n){var t=n.$el,e=t.find(".ninja-compare-checkbox");if(e.length){var a=t.find(".nt_fct_variations_wrapper"),r=a.length>0,i=r&&a.find(".nt_fct_variations_select").val()||0,c="add_to_cart"!==o||(!r||i&&parseInt(i,10)>0);e.css("visibility",c?"visible":"hidden").prop("checked",!!c&&e.prop("checked"))}}),e[a]=!1,t[a]=i(n),b(n,a))},f=function(n,e){var a=[],o=FooTable.get(n);return o?(o.rows.all.forEach(function(n){var o,i=r(n.$el);if(t[e].includes(i)){var c,d=n.$el,l=(c=".nt_fct_add_cart_wrapper .nt_button",d.find(c).length?d.find(c):d.next().find(c)),p={product_id:parseInt(l.data("product_id"))||0,variation_id:parseInt(l.data("variation_id")||0,10),quantity:parseInt(l.data("quantity")||1,10)},f=null===(o=d.attr("class").match(/nt_row_id_(\S+)/))||void 0===o?void 0:o[1];a.push(function(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?u(Object(e),!0).forEach(function(t){s(n,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):u(Object(e)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))})}return n}({cart:p,row_id:f},n.value))}}),a):a},_=function(n,a){e[a]=!0,n.find(".ninja-compare-checkbox").prop("checked",!1),e[a]=!1,t[a]=[],b(n,a)},b=function(n,e){var a=n.closest(".ninja_table_wrapper"),o=n.find(".ninja-compare-checkbox-toggle"),r=n.find("tbody tr:visible .ninja-compare-checkbox"),i=r.filter(":checked").length,c=r.length;o.prop({indeterminate:i>0&&i<c&&i<20,checked:i>0&&(i>=20||i===c)});var d=t[e].length>0,l=a.find(".ninja-bulk-action-select").data("action");a.find(".ninja-bulk-action-select").prop("disabled",!d),a.find(".ninja-bulk-apply-btn").prop("disabled",!d||!l)};n(document).on("ninja_table_loaded",function(n,o,r){try{!function(n,o){var r;if("wp_fct"===o.provider&&"yes"===(null===(r=o.settings)||void 0===r||null===(r=r.appearance_settings)||void 0===r?void 0:r.show_bulk_actions)){l.init(n,o);var p=o.table_id;t[p]=[],e[p]=!1,a=o,c(n,p,o),d(n,p),t[p]=i(n),b(n,p)}}(o,r)}catch(n){console.error("Bulk Compare Init Error:",n)}})})})();