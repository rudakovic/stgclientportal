/**
 * SuperSide Me main js engine
 * @package   SuperSideMe
 * @author    Robin Cornett
 * @copyright 2015-2020 Robin Cornett
 * @license   GPL-2.0+
 */
!function(e,s,a){"use strict";var n={},t="slide-menu",r="side-menu",i="slide-nav-link",o="sub-menu-toggle",p="menu-open",u="ssme-search",l="ssme-buttons",d="screen-reader-text",c="supersideme",m="sidr-inner",f="menu-close",b={sidr:"."+"sidr",panel:"#"+r,menuButton:"."+i,submenuToggle:"."+o,button:"#"+t,searchButton:"."+u,buttonWrap:"."+l,searchInput:"."+l+" .search-me",inner:"."+m},g={menus:{},search:{}};function h(){var a;a=null!==n.params.source&&null!==e.getElementById(n.params.source)?"#"+n.params.source:function(){!function(){var a=n.params.html5?"nav":"div",t=n.params.html5?{class:"side-navigation",role:"navigation",itemscope:"itemscope",itemtype:"http://schema.org/SiteNavigationElement"}:{class:"side-navigation"},i=s("<"+a+" />",t).append(s("<ul />",{class:"side-nav"})),o=s("<div />",{class:m}),p={widget:".supersideme.widget-area",inner:b.panel+" "+b.inner};if(0===s(p.inner).length){s(b.panel+b.sidr).prepend(o);var u=g.menus;if(n.params.menus&&(u=n.params.menus),u&&(s(p.inner).append(i),s(".side-nav").prepend(u)),0!==r.length&&I(r)&&e.getElementById(r).style.setProperty("display","block"),0!==s(p.widget).length){var l=n.params.widget_end?"appendTo":"prependTo";s(p.widget)[l](p.inner).attr("style","display:block;")}if(n.params.search.panel||E()){var d=g.search;n.params.search.input&&(d=n.params.search.input),s(p.inner).prepend(d),E()&&!Boolean(n.params.panel)&&s(".search-me").css("display","none")}}}()},C({button:b.button,source:a,panel:r,side:n.params.side},"#"+r+" "+b.submenuToggle),!0,s.sidr("open",r)}function v(){return s.sidr("close",r),s(b.sidr+" "+b.submenuToggle).removeClass(p).attr("aria-expanded",!1).next(".sub-menu").slideUp("fast"),!1}n.init=function(){!function(e){(function(e){var a=n.params.navarialabel,t=d,r=B(),o=n.params.function;n.params.navigation&&(a=n.params.navigation,t="label");s(".genesis-skip-link").length>0&&"prepend"===o&&!r&&(r=".genesis-skip-link",o="after");r||(r="body");E()&&(a=parent.wp.customize.instance("supersideme[navigation]").get());var p=s("<div />",{class:"ssme-wrapper"}).append(S("menu")).append(s("<span />",{class:t,text:a})),u=s("<button />",{"aria-pressed":!1,"aria-expanded":!1,disabled:!0,id:e,class:i+" ssme-button"}).append(p);s(r).first()[o](u),s("body").addClass(c)})(e),function(){if(!n.params.search.button&&0===n.params.custom.length)return;s(B()).length<1&&s(b.button).wrap("<div />");s(b.button).parent().addClass(l)}(),void s.ajax({dataType:"JSON",url:n.params.rest,success:function(e){g.menus=e.data.menus,g.search=e.data.search},complete:function(){s(b.button).attr("disabled",!1),function(){var e=s(b.buttonWrap),a="after",t="last-of-type",r="";"0px"===e.css("bottom")&&s.inArray(e.css("position"),["absolute","fixed"])>-1&&(a="before",t="first-of-type",r=-5);var i=g.search;n.params.search.input&&(i=n.params.search.input),s(b.buttonWrap+" > button:"+t)[a](i),s(b.searchButton).attr("disabled",!1),s(b.searchInput).css("display","none").css("order",r)}()}}),(n.params.search.button||E())&&function(){if(!n.params.search.button)return;var e=O()?"before":"after";s(b.button)[e](function(){var e=n.params.search.button_aria,a=d;n.params.search.button_text&&(e=n.params.search.button_text,a="label");E()&&(e=parent.wp.customize.instance("supersideme[search_button_text]").get());var t=s("<div />",{class:"ssme-wrapper"}).append(S("search")).append(s("<span />",{class:a,text:e}));return s("<button />",{"aria-pressed":!1,id:u,class:u,disabled:!0}).append(t)}()),n.params.search.button||s(b.searchButton).css("display","none");s(b.searchButton).on("click.search",(function(){s(b.searchInput).slideToggle(200),_(s(b.searchButton),"aria-pressed")}))}();if(function(){if(!n.params.custom)return;Object.keys(n.params.custom).forEach((function(e){if(n.params.custom.hasOwnProperty(e)){var a=n.params.custom[e],t=a.label.replace(/\s+/g,"-").toLowerCase(),r=!a.show&&a.icon?d:"label",i={href:a.link,class:"button ssme-button ssme-custom ssme-"+t};a.new&&(i.target="_blank",i.rel="noopener");var o=s("<div />",{class:"ssme-wrapper"}).append(a.icon).append(s("<span />",{class:r,text:a.label})),p=s("<a />",i).append(o);a.text&&p.append(a.text);var u=O()?"before":"after";s(b.button)[u](p)}}))}(),0===b.button.length)return;s(b.button).on("click.supersideme",(function(){h()})),s("undefined"!==n.params.second.button)&&s(n.params.second.button).on("click.second-ssme",(function(){var e;C(e=n.params.second,"#"+e.panel+" "+b.submenuToggle),!0,s.sidr("open",e.panel)}));s(window).on("resize.supersideme",T).triggerHandler("resize.supersideme")}(t)};var k,y,w,x,T=(k=function(){var e,a,r=t;e=r,a=s("body"),I(e)?a.removeClass(c):a.addClass(c),n.params.swipe&&function(e,a){I(e)?s(a).swipe("disable"):(s(a).swipe("enable"),function(e){var s=h,a=v;"left"===n.params.side&&(s=v,a=h),e.swipe({allowPageScroll:"vertical",threshold:120,swipeLeft:s,swipeRight:a,preventDefaultEvents:!1})}(s(a)))}(r,"body"),n.skipLinks="undefined"==typeof supersidemeSkipLinks?"":supersidemeSkipLinks,void 0!==n.skipLinks&&function(e){var a=n.skipLinks.startLink,t=e,r=s(n.skipLinks.ulClass+' a[href*="#'+n.skipLinks.contains+'"]').not('a[href*="'+n.skipLinks.unique+'"]');I(e)?(a=e,t=n.skipLinks.startLink,s(r).removeAttr("style")):s(r).hide();var i=s(n.skipLinks.ulClass+' a[href*="#'+a+'"]'),o=s(i).attr("href");o&&(o=o.replace(a,t),s(i).attr("href",o))}(r),I(r)&&(s(b.searchInput).hide(),v())},y=250,function(){var e=this,s=arguments,a=function(){x=null,w||k.apply(e,s)},n=w&&!x;clearTimeout(x),x=setTimeout(a,y),n&&k.apply(e,s)});function C(e,a){var t;return function(e,a){var t=s.sidr("status");t.opened!==a.panel&&s.sidr("close",t.opened);e.sidr({name:a.panel,side:a.side,source:a.source,renaming:!1,displace:n.params.displace,speed:parseInt(n.params.speed,10),method:"toggle",onOpen:function(){e.toggleClass(p),_(e,"aria-pressed"),_(e,"aria-expanded"),function(e){var a=s(b.sidr+" "+b.inner),n=a.children(),t=n.first(),r=n.last();a.attr({tabindex:"0"}),t.focus(),a.on("keydown.sidrNav",(function(s){if(9===s.keyCode)return(r[0]!==s.target||s.shiftKey)&&(t[0]!==s.target&&a[0]!==s.target||!s.shiftKey)?void 0:(e.focus(),!1)})),e.on("keydown.sidrNav",(function(s){if(jQuery.sidr("status").opened&&9===s.keyCode)return e[0]!==s.target||s.shiftKey?void 0:(t.focus(),!1)}))}(e)},onClose:function(){e.removeClass(p),_(e,"aria-pressed"),_(e,"aria-expanded"),e.focus(),!1}})}(s(e.button),e),0===s(a).length&&(!function(e){var a=s("<button />",{"aria-pressed":!1,"aria-label":n.params.subarialabel,class:o}).append(S("submenu")).append(s("<span />",{class:d,text:n.params.submenu}));if(0!==s(e+" "+b.submenuToggle).length)return;s(b.sidr+" .sub-menu").before(a),t=b.sidr+" .menu-item-has-children > a",r=b.sidr+" "+b.submenuToggle,s(r).css("height",s(t).outerHeight());var t,r}(e.panel),s((t=b.sidr+" .menu-item-has-children ")+'> a[href="#"], '+t+"> a:not([href])").append(S("submenu")).addClass(o).attr("role","button").attr("aria-pressed",!1).next(b.submenuToggle).remove()),s(b.sidr+" "+b.submenuToggle).on("click.supersideme-submenu",L),function(e,a){var t=e.indexOf("#")<=0?"#"+e:e,r=function(e){if(!s.isPlainObject(n.params.close))return n.params.close;var a=n.params.close.closeAria,t=d;n.params.close.closeText&&(a=n.params.close.closeText,t="label");void 0!==e.close&&(a=e.close,t="label");return s("<button />",{"aria-pressed":!1,"aria-label":n.params.close.closeAria,class:f}).append(S("close")).append(s("<span />",{class:t,text:a}))}(a);0===s(t+" ."+f).length&&s(t+" "+b.sidr+"-inner").prepend(r);s(t+" "+n.params.closeevent).on("click",(function(){s(this).attr("aria-pressed",!1),s.sidr("close",e),s(b.sidr+" "+b.submenuToggle).removeClass(p).attr("aria-expanded",!1).next(".sub-menu").slideUp("fast")}))}(e.panel,e),!1}function L(){var e=s(this),a=e.closest(".menu-item").siblings();_(e,"aria-pressed"),e.toggleClass(p),e.next(".sub-menu").slideToggle("fast"),a.find(b.submenuToggle).removeClass(p).attr("aria-pressed",!1),a.find(".sub-menu").slideUp("fast")}function B(){return s(n.params.location).length>0&&n.params.location}function S(e){return n.params.svg?n.params.svg[e]:""}function I(s){var a=e.getElementById(s);return"none"===window.getComputedStyle(a).getPropertyValue("display")}function _(e,s){e.attr(s,(function(e,s){return"false"===s}))}function E(){return Boolean(n.params.customizer)}function O(){return Boolean("right"===n.params.side)}n.params="undefined"==typeof SuperSideMeVar?"":SuperSideMeVar,void 0!==n.params&&n.init()}(document,jQuery);